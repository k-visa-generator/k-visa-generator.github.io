{{- $params := .Site.Params }}
{{- $centerLogo := $params.centerLogo }}
{{ $logo := $params.logo }}
<header class="nav_header" >
  <nav class="nav">
    {{- if $centerLogo }}
      {{- partialCached "logo" (dict "logo" $logo "class" "nav_hide") }}
    {{- else }}
      {{- partialCached "logo" (dict "logo" $logo) }}
    {{- end }}
    <div class='nav_body nav_body_{{ default "left" $params.mobileNavigation }}'>
      {{ $context := . }}
      {{ $menuData := .Site.Data.menu }}
      {{ with $menuData }}
        {{ partial "nav" (dict "context" $context "menu" $menuData) }}
      {{- else }}
        {{ partial "nav" (dict "context" . "menu" .Site.Menus.main) }}
      {{- end }}

      {{ if hugo.IsMultilingual }}
      <style>
        .lang-select-wrapper {
          position: relative;
          display: inline-block;
        }
        .custom-lang-select {
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          background-color: rgba(255, 255, 255, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.3);
          color: #ffffff;
          padding: 6px 30px 6px 12px;
          border-radius: 20px;
          font-size: 0.85rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;
          background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
          background-repeat: no-repeat;
          background-position: right 8px center;
          background-size: 14px;
        }

        .custom-lang-select:hover {
          background-color: rgba(255, 255, 255, 0.2);
          border-color: rgba(255, 255, 255, 0.6);
        }

        .custom-lang-select:focus {
          outline: none;
          border-color: #ffffff;
        }

        .custom-lang-select option {
          background-color: #ffffff;
          color: #333333;
          padding: 10px;
        }

        /* ğŸ’» ë°ìŠ¤í¬íƒ‘: ë©”ë‰´ì™€ ë‹¤í¬ëª¨ë“œ ì•„ì´ì½˜ ì‚¬ì´ ìš°ì¸¡ì— ì˜ˆì˜ê²Œ ë°°ì¹˜ */
        @media screen and (min-width: 769px) {
          .nav_lang_wrapper {
            margin-left: auto;
            margin-right: 1.5rem;
            display: flex;
            align-items: center;
          }
        }

        /* ğŸ“± ëª¨ë°”ì¼: ì ˆëŒ€ìœ„ì¹˜ í•´ì œ ë° ì„œëì¥ ë‚´ë¶€ ì™„ë²½ ì •ë ¬ */
        @media screen and (max-width: 768px) {
          .nav_body {
            display: flex;
            flex-direction: column;
            padding-top: 4.5rem; /* ë¡œê³  ì˜ì—­ í”¼í•˜ê¸° */
          }

          /* 1. í…Œë§ˆì˜ ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ (ìœ„ì¹˜ ê³ ì • ë° ì¢Œì¸¡ ì—¬ë°± ì¹¼ê°) */
          .nav_body .nav_theme,
          .nav_body .color_mode {
            position: relative !important;
            top: auto !important;
            right: auto !important;
            left: auto !important;
            margin: 0 0 1rem 1.5rem !important; /* ğŸ’¡ í•˜ë‹¨ 1rem, ì¢Œì¸¡ 1.5rem ê³ ì • */
            order: 1;
            align-self: flex-start;
          }

          /* 2. ì–¸ì–´ ì„ íƒê¸° ë°°ì¹˜ */
          .nav_lang_wrapper {
            order: 2;
            margin: 0 1.5rem 1.5rem 0.5rem !important; /* ğŸ’¡ ìƒë‹¨ 0, ì¢Œì¸¡ 1.5rem (ë‹¤í¬ëª¨ë“œì™€ ë™ì¼) */
            width: calc(100% - 3rem);
          }
          .custom-lang-select {
            width: 100%;
          }
        }
      </style>

      <div class="nav_item nav_lang_wrapper">
        <div class="lang-select-wrapper" style="width: 100%;">
          <select class="custom-lang-select" onchange="location = this.value;">
              {{ range .Site.Home.AllTranslations }}
                  {{ $url := .Permalink }}
                  {{ $lang := .Language }}

                  {{ range $.AllTranslations }}
                      {{ if eq .Language.Lang $lang.Lang }}
                          {{ $url = .Permalink }}
                      {{ end }}
                  {{ end }}

                  <option value="{{ $url }}" {{ if eq $lang.Lang $.Language.Lang }}selected{{ end }}>
                      {{ $lang.LanguageName }}
                  </option>
              {{ end }}
          </select>
        </div>
      </div>
      {{- end }}

      {{- if $centerLogo }}
        {{- partial "logo" (dict "logo" $logo "class" "nav_center") }}
      {{- end }}
      {{- partialCached "follow" . }}
    </div>
  </nav>
</header>
